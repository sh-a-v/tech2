(function(){"use strict";var app;app=angular.module("engineerium",["ui.router","ngResource","ngTouch","popup","user"]),app.config(function($stateProvider,$locationProvider,$resourceProvider){$stateProvider.state("index",{url:"/",title:"Engineerium"}).state("cabinet",{url:"/cabinet",title:"Кабинет"}).state("catalog",{url:"/catalog",title:"Каталог"}).state("search",{url:"/search",title:"Поиск"}),$locationProvider.html5Mode({enabled:!0,requireBase:!1}),$resourceProvider.defaults.stripTrailingSlashes=!0}),app.urls={api:"http://api.engineerium.io:1337"},app.controller("AppContainerCtrl",function(){}),app.directive("appContainer",function(){return{restrict:"EA",controller:"AppContainerCtrl",link:function(){}}}),app.controller("MenuCtrl",function(){}),app.directive("menu",function(){return{restrict:"EA",controller:"MenuCtrl",scope:{},link:function(){}}}),app.controller("HeaderControlsCtrl",function(){}),app.directive("HeaderControls",function(){return{restrict:"E",controller:"HeaderControlsCtrl",link:function(){}}}),app.popup=angular.module("popup",[]),app.user=angular.module("user",[]),app.popup.controller("PopupCtrl",function($rootScope,$scope,popupService){this.service=popupService,this.active=this.service.active,this.activate=function(){return this.active=!0,this._broadcastPopupActivated(),console.log("activate")},this.deactivate=function(){return this.active=!1,this._broadcastPopupDeactivated()},this.isActive=function(){return this.active},this._broadcastPopupActivated=function(){return $scope.$broadcast("popup:activated")},this._broadcastPopupDeactivated=function(){return $scope.$broadcast("popup:deactivated")}}),app.popup.directive("popup",function(){return{restrict:"E",controller:"PopupCtrl",link:function(){}}}),app.popup.factory("popupService",function(){var PopupService;return new(PopupService=function(){function PopupService(){}return PopupService.prototype.active=!1,PopupService.prototype.activate=function(){return this.active=!0},PopupService.prototype.deactivate=function(){return this.active=!1},PopupService.prototype.isActive=function(){return this.active},PopupService}())}),app.user.controller("UserControlCtrl",function(){}),app.user.directive("userControl",function(){return{restrict:"EA",controller:"UserCtrl",link:function(){}}}),app.user.controller("UserCtrl",function($rootScope,$scope,userService){return userService.checkAuthentication()}),app.user.factory("authResource",function($resource){return $resource(app.urls.api+"/auth/",null,{update:{method:"PUT"}})}),app.user.service("userService",function($rootScope,authResource){return{user:{authentication:!1},updateUser:function(user){return this.user=angular.extend(user,this.user)},authenticate:function(){return authResource.save().$promise.then(function(_this){return function(res){return res.success&&_this.updateUser(res.user),res}}(this))},deauthenticate:function(){return this.user.authentication=!1},checkAuthentication:function(){return authResource.get().$promise.then(function(_this){return function(res){return res.success&&_this.updateUser(res.user),res}}(this))},isAuthenticated:function(){return this.user.authentication}}})}).call(this);